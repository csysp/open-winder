# home-secnet Environment Configuration
# Copy this file to .env and customize the values

# Core WAN Configuration
ISP_WAN_TYPE=dhcp
# For static WAN, uncomment and configure:
# WAN_STATIC_IP=198.51.100.2/24
# WAN_STATIC_GW=198.51.100.1
# WAN_STATIC_DNS="1.1.1.1 9.9.9.9"

# DNS Stack
DNS_STACK=adguard
DNS_RECURSORS="9.9.9.9 1.1.1.1"
SECURITY_SCANNERS_ENABLE=false

# Network Segmentation
USE_VLANS=false

# VLAN Configuration (when USE_VLANS=true)
VLAN_TRUSTED=20
VLAN_IOT=30
VLAN_GUEST=40
VLAN_LAB=50

# Network Subnets
NET_TRUSTED=10.20.0.0/24
NET_IOT=10.30.0.0/24
NET_GUEST=10.40.0.0/24
NET_LAB=10.50.0.0/24

# Gateway IPs
GW_TRUSTED=10.20.0.1
GW_IOT=10.30.0.1
GW_GUEST=10.40.0.1
GW_LAB=10.50.0.1

# DHCP Ranges
DHCP_TRUSTED_RANGE="10.20.0.100 10.20.0.200"
DHCP_IOT_RANGE="10.30.0.100 10.30.0.200"
DHCP_GUEST_RANGE="10.40.0.100 10.40.0.200"
DHCP_LAB_RANGE="10.50.0.100 10.50.0.200"

# Router Interface Names
ROUTER_WAN_IF=ens18
ROUTER_LAN_IF=ens19

# WireGuard Configuration
WG_PORT=51820
WG_NET=10.66.66.0/24
WG_SERVER_IP=10.66.66.1/24
WG_ALLOWED_IPS="0.0.0.0/0, ::/0"
WG_PERSISTENT_KEEPALIVE=25
WG_DNS=10.66.66.1

# WireGuard Wrapper (Hysteria2)
WRAP_MODE=none
# When WRAP_MODE=hysteria2, configure:
# WRAP_LISTEN_PORT=443
# WRAP_PASSWORD=""
# WRAP_DOMAIN=""

# Single Packet Authorization (SPA)
SPA_ENABLE=false
# PQ-KEM SPA (control-plane). Only pqkem supported.
SPA_MODE=pqkem
SPA_PQ_KEM=MLKEM768
SPA_PQ_PORT=62201
SPA_PQ_OPEN_SECS=45
SPA_PQ_WINDOW_SECS=30
SPA_PQ_PSK_FILE=/etc/spa/psk.bin
# SPA artifact version (GitHub Release tag) to fetch; use a tag like v0.1.0 or 'latest'
SPA_PQ_VERSION=latest
# Optional: signature URL for checksum (provide /etc/spa/pubkey.gpg on router)
SPA_PQ_SIG_URL=

# Double-Hop Egress
DOUBLE_HOP_ENABLE=false
# When DOUBLE_HOP_ENABLE=true, configure:
# WG2_ADDRESS=10.67.0.2/32
# WG2_ENDPOINT=exit.example.com:51820
# WG2_PEER_PUBLIC_KEY=""
# WG2_ALLOWED_IPS=0.0.0.0/0

# Proxmox Configuration
PVE_NODE=""
ISO_STORAGE=local
DISK_STORAGE=local-lvm

# Router VM Configuration
ROUTER_VM_ID=201
ROUTER_VM_NAME=router-vm
ROUTER_CPU=4
ROUTER_RAM=4096
ROUTER_ADMIN_USER=admin
ROUTER_ADMIN_PUBKEY="ssh-ed25519 AAAA... yourkey"

# Logging VM Configuration

# Security Configuration
DISABLE_USB_STORAGE=true
HARDEN_AUDITD=true
INSTALL_AIDE=true
FAIL2BAN_ENABLE=true

# AdGuard Home Version
ADGUARD_VERSION=latest

# Alert Email Configuration
ALERT_EMAIL=""
# Remote syslog forwarding (optional)
RSYSLOG_FORWARD_ENABLE=false
RSYSLOG_REMOTE=log.example.org:514
SMTP_ENABLE=false
# When SMTP_ENABLE=true, configure:
# SMTP_HOST=""
# SMTP_PORT=587
# SMTP_USER=""
# SMTP_PASS=""
# SMTP_FROM=""
# ===== Ultralight Mode =====
ULTRALIGHT_MODE=false

# IDS/IPS & packet handling
IDS_MODE=none               # none | nft-guard | ebpf-lite
NFT_GUARD_ENABLE=true
NFT_SYNOPROXY_ENABLE=true
NFT_RATE_LIMIT_ENABLE=true
NFT_BOGONS_ENABLE=true
NFT_DYNAMIC_BAN_ENABLE=false    # default off for zero state

# DNS/DHCP stack
# Override defaults below when enabling ultralight
DNS_STACK=adguard           # unbound | adguard
DHCP_STACK=dnsmasq          # dnsmasq | isc
DNS_BLOCKLISTS_MIN=true     # only tiny curated list if AdGuard is used

# WireGuard + SPA remain as configured above
SPA_ENABLE=true
SPA_MODE=pqkem
SPA_PQ_PORT=62201
SPA_PQ_OPEN_SECS=45
SPA_PQ_WINDOW_SECS=30

# Shaping
SHAPING_ENABLE=true
SHAPING_EGRESS_KBIT=0       # 0 = off; set to WAN up kbit with headroom
SHAPING_INGRESS_KBIT=0      # 0 = off; set to WAN down kbit with headroom
SHAPING_DSCP_ENABLE=false   # true to use diffserv4 in CAKE

# Logs
LOG_VERBOSITY=minimal       # minimal | normal
LOG_ROTATE_DAYS=7

# ===== OpenWRT Build & Profile =====
OPENWRT_VERSION=23.05.4
OPENWRT_TARGET=x86/64
OPENWRT_PROFILE=generic
# Optional checksum for ImageBuilder tarball (strongly recommended for reproducibility)
OPENWRT_IB_SHA256=

# Device interfaces (OpenWRT). Fallback to ROUTER_*_IF if unset.
LAN_IF=lan0
WAN_IF=wan0

# Host identity
ROUTER_HOSTNAME=winder
TZ=UTC

# DNS UI bind (AdGuard Home)
ADGUARD_UI_LISTEN=127.0.0.1:3000

# Extra packages to include in image builder
EXTRA_PACKAGES=

# SPA secret (base64, generated automatically if empty)
SPA_PQ_PSK_B64=
# Operating mode for this branch
# Supported: openwrt
MODE=openwrt
# IDS (optional)
# Enable Suricata inline IDS on LAN bridge. Logs to /var/log/suricata/eve.json
SURICATA_ENABLE=true
SURICATA_IFACES=br-lan
SURICATA_EVE_ENABLE=true
SURICATA_HOME_NET="[192.168.1.0/24]"

# LAN addressing (used by OpenWRT network template)
LAN_ADDR=192.168.1.1
LAN_NETMASK=255.255.255.0

# Shaping / SQM (optional; prefer SQM over custom tc)
SHAPING_ENABLE=false
SHAPING_EGRESS_KBIT=
SHAPING_INGRESS_KBIT=
SQM_INTERFACE=wan

# WireGuard egress (optional, client-side wg1)
WG2_ENABLE=false
WG2_PRIVATE_KEY=
WG2_ADDRESS=
WG2_ENDPOINT_HOST=
WG2_ENDPOINT_PORT=51820
WG2_PEER_PUBLIC_KEY=
WG2_PERSISTENT_KEEPALIVE=25
WG2_ALLOWED_IPS=0.0.0.0/0

# Multi-WAN policy (optional) â€” use OpenWRT mwan3 (no third-party services)
MWAN3_ENABLE=false
