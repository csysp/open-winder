#!/bin/sh /etc/rc.common
# SPDX-License-Identifier: GPL-2.0-only

START=96
USE_PROCD=1
PROG=/usr/bin/hysteria
CONF=/etc/hysteria/config.yaml

start_service() {
    [ -x "$PROG" ] || exit 0
    [ -f "$CONF" ] || exit 0
    procd_open_instance
    procd_set_param command "$PROG" server -c "$CONF"
    procd_set_param respawn 300 5 0
    procd_set_param stdout 1
    procd_set_param stderr 1
    procd_close_instance
}

stop_service() {
    killall hysteria 2>/dev/null || true
}

